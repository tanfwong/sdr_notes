
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.4.5. stream.hpp &#8212; Digital Communications with SDRs</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="wing.ece.ufl.edu/eel6528/stream.html" />
    <link rel="shortcut icon" href="_static/logo.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2.4.6. tx_samples_from_file.cpp" href="tx_samples_from_file.html" />
    <link rel="prev" title="2.4.4. txrx_loopback_to_file.cpp (stream)" href="txrx_stream.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="wing.ece.ufl.edu/eel6528/stream.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="stream.hpp" />
<meta property="og:description" content="stream.hpp  Source code  // // Copyright 2011-2013 Ettus Research LLC // Copyright 2018 Ettus Research, a National Instruments Company // // SPDX-License-Identi" />
<meta property="og:image"       content="wing.ece.ufl.edu/eel6528/_static/logo.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Digital Communications with SDRs</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   EEL6528 Digital Communications with Software Defined Radios
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="prelims.html">
   2. Some Programming Prelims
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="uhd.html">
     2.1. UHD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="multithread.html">
     2.2. Elementary Multi-threading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="prelims_exs.html">
     2.3. References and further reading
    </a>
   </li>
   <li class="toctree-l2 current active collapsible-parent">
    <a class="reference internal" href="prelims_exs.html#code-examples">
     2.4. Code Examples
    </a>
    <ul class="current collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="uhd_safe_main.html">
       2.4.1.
       <code class="docutils literal notranslate">
        <span class="pre">
         uhd_safe_main.hpp
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="age.html">
       2.4.2.
       <code class="docutils literal notranslate">
        <span class="pre">
         age.cpp
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="txrx_setup.html">
       2.4.3.
       <code class="docutils literal notranslate">
        <span class="pre">
         txrx_loopback_to_file.cpp
        </span>
       </code>
       (setup)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="txrx_stream.html">
       2.4.4.
       <code class="docutils literal notranslate">
        <span class="pre">
         txrx_loopback_to_file.cpp
        </span>
       </code>
       (stream)
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       2.4.5.
       <code class="docutils literal notranslate">
        <span class="pre">
         stream.hpp
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tx_samples_from_file.html">
       2.4.6.
       <code class="docutils literal notranslate">
        <span class="pre">
         tx_samples_from_file.cpp
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="txrx_TX.html">
       2.4.7.
       <code class="docutils literal notranslate">
        <span class="pre">
         txrx_loopback_to_file.cpp
        </span>
       </code>
       (TX)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="txrx_RX.html">
       2.4.8.
       <code class="docutils literal notranslate">
        <span class="pre">
         txrx_loopback_to_file.cpp
        </span>
       </code>
       (RX)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="age_threads.html">
       2.4.9.
       <code class="docutils literal notranslate">
        <span class="pre">
         age_threads.cpp
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="txrx_thread.html">
       2.4.10.
       <code class="docutils literal notranslate">
        <span class="pre">
         txrx_loopback_to_file.cpp
        </span>
       </code>
       (thread)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="age_mutex.html">
       2.4.11.
       <code class="docutils literal notranslate">
        <span class="pre">
         age_mutex.cpp
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="age_mutex_caller.html">
       2.4.12.
       <code class="docutils literal notranslate">
        <span class="pre">
         age_mutex_caller.cpp
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="count_atomic.html">
       2.4.13.
       <code class="docutils literal notranslate">
        <span class="pre">
         count_atomic.cpp
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="queue.html">
       2.4.14.
       <code class="docutils literal notranslate">
        <span class="pre">
         queue.hpp
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="age_fifo.html">
       2.4.15.
       <code class="docutils literal notranslate">
        <span class="pre">
         age_fifo.cpp
        </span>
       </code>
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="filter.html">
   3. Multi-rate Filtering
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="fftw3.html">
     3.1. FFTW3 Library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="filter_exs.html">
     3.2. References and further reading
    </a>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="filter_exs.html#code-examples">
     3.3. Code Examples
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="fft.html">
       3.3.1.
       <code class="docutils literal notranslate">
        <span class="pre">
         fft.hpp
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="test_fft.html">
       3.3.2.
       <code class="docutils literal notranslate">
        <span class="pre">
         test_fft.cpp
        </span>
       </code>
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/stream.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#source-code">
   2.4.5.1. Source code
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="stream-hpp">
<span id="code-stream"></span><h1><span class="section-number">2.4.5. </span><code class="docutils literal notranslate"><span class="pre">stream.hpp</span></code><a class="headerlink" href="#stream-hpp" title="Permalink to this headline">¶</a></h1>
<div class="section" id="source-code">
<h2><span class="section-number">2.4.5.1. </span>Source code<a class="headerlink" href="#source-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">//</span>
<span class="c1">// Copyright 2011-2013 Ettus Research LLC</span>
<span class="c1">// Copyright 2018 Ettus Research, a National Instruments Company</span>
<span class="c1">//</span>
<span class="c1">// SPDX-License-Identifier: GPL-3.0-or-later</span>
<span class="c1">//</span>

<span class="cp">#ifndef INCLUDED_UHD_STREAM_HPP</span>
<span class="cp">#define INCLUDED_UHD_STREAM_HPP</span>

<span class="cp">#include</span> <span class="cpf">&lt;uhd/config.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;uhd/types/device_addr.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;uhd/types/metadata.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;uhd/types/ref_vector.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;uhd/types/stream_cmd.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;uhd/utils/noncopyable.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;boost/shared_ptr.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;boost/utility.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">uhd</span> <span class="p">{</span>

<span class="cm">/*!</span>
<span class="cm"> * A struct of parameters to construct a streamer.</span>
<span class="cm"> *</span>
<span class="cm"> * Here is an example of how a stream args object could be used in conjunction</span>
<span class="cm"> * with uhd::device::get_rx_stream():</span>
<span class="cm"> *</span>
<span class="cm"> * \code{.cpp}</span>
<span class="cm"> * // 1. Create the stream args object and initialize the data formats to fc32 and sc16:</span>
<span class="cm"> * uhd::stream_args_t stream_args(&quot;fc32&quot;, &quot;sc16&quot;);</span>
<span class="cm"> * // 2. Set the channel list, we want 3 streamers coming from channels</span>
<span class="cm"> * //    0, 1 and 2, in that order:</span>
<span class="cm"> * stream_args.channels = {0, 1, 2};</span>
<span class="cm"> * // 3. Set optional args:</span>
<span class="cm"> * stream_args.args[&quot;spp&quot;] = &quot;200&quot;; // 200 samples per packet</span>
<span class="cm"> * // Now use these args to create an rx streamer:</span>
<span class="cm"> * // (We assume that usrp is a valid uhd::usrp::multi_usrp)</span>
<span class="cm"> * uhd::rx_streamer::sptr rx_stream = usrp-&gt;get_rx_stream(stream_args);</span>
<span class="cm"> * // Now, any calls to rx_stream must provide a vector of 3 buffers,</span>
<span class="cm"> * // one per channel.</span>
<span class="cm"> * \endcode</span>
<span class="cm"> *</span>
<span class="cm"> * \b Note: Not all combinations of CPU and OTW format have conversion support.</span>
<span class="cm"> * You may however write and register your own conversion routines.</span>
<span class="cm"> *</span>
<span class="cm"> * If you are creating stream args to connect to an RFNoC block, then you might</span>
<span class="cm"> * want to specify block ID and port, too:</span>
<span class="cm"> * \code{.cpp}</span>
<span class="cm"> * stream_args.args[&quot;block_id0&quot;] = &quot;0/Radio_0&quot;;</span>
<span class="cm"> * stream_args.args[&quot;block_id1&quot;] = &quot;0/Radio_1&quot;;</span>
<span class="cm"> * stream_args.args[&quot;block_id2&quot;] = &quot;0/Radio_1&quot;; // Chan 1 and 2 go to the same radio</span>
<span class="cm"> * stream_args.args[&quot;block_port0&quot;] = &quot;0&quot;;</span>
<span class="cm"> * stream_args.args[&quot;block_port1&quot;] = &quot;0&quot;;</span>
<span class="cm"> * stream_args.args[&quot;block_port2&quot;] = &quot;1&quot;;</span>
<span class="cm"> * \endcode</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="nc">UHD_API</span> <span class="n">stream_args_t</span>
<span class="p">{</span>
    <span class="c1">//! Convenience constructor for streamer args</span>
    <span class="n">stream_args_t</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">cpu</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">otw</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">cpu_format</span> <span class="o">=</span> <span class="n">cpu</span><span class="p">;</span>
        <span class="n">otw_format</span> <span class="o">=</span> <span class="n">otw</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/*!</span>
<span class="cm">     * The CPU format is a string that describes the format of host memory.</span>
<span class="cm">     * Conversions for the following CPU formats have been implemented:</span>
<span class="cm">     *  - fc64 - complex&lt;double&gt;</span>
<span class="cm">     *  - fc32 - complex&lt;float&gt;</span>
<span class="cm">     *  - sc16 - complex&lt;int16_t&gt;</span>
<span class="cm">     *  - sc8 - complex&lt;int8_t&gt;</span>
<span class="cm">     *</span>
<span class="cm">     * The following are not implemented, but are listed to demonstrate naming convention:</span>
<span class="cm">     *  - f32 - float</span>
<span class="cm">     *  - f64 - double</span>
<span class="cm">     *  - s16 - int16_t</span>
<span class="cm">     *  - s8 - int8_t</span>
<span class="cm">     *</span>
<span class="cm">     * The CPU format can be chosen depending on what the application requires.</span>
<span class="cm">     */</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">cpu_format</span><span class="p">;</span>

    <span class="cm">/*!</span>
<span class="cm">     * The OTW format is a string that describes the format over-the-wire.</span>
<span class="cm">     * The following over-the-wire formats have been implemented:</span>
<span class="cm">     *  - sc16 - Q16 I16</span>
<span class="cm">     *  - sc8 - Q8_1 I8_1 Q8_0 I8_0</span>
<span class="cm">     *  - sc12 (Only some devices)</span>
<span class="cm">     *</span>
<span class="cm">     * The following are not implemented, but are listed to demonstrate naming convention:</span>
<span class="cm">     *  - s16 - R16_1 R16_0</span>
<span class="cm">     *  - s8 - R8_3 R8_2 R8_1 R8_0</span>
<span class="cm">     *</span>
<span class="cm">     * Setting the OTW (&quot;over-the-wire&quot;) format is, in theory, transparent to the</span>
<span class="cm">     * application, but changing this can have some side effects. Using less bits for</span>
<span class="cm">     * example (e.g. when going from `otw_format` `sc16` to `sc8`) will reduce the dynamic</span>
<span class="cm">     * range, and increases quantization noise. On the other hand, it reduces the load on</span>
<span class="cm">     * the data link and thus allows more bandwidth (a USRP N210 can work with 25 MHz</span>
<span class="cm">     * bandwidth for 16-Bit complex samples, and 50 MHz for 8-Bit complex samples).</span>
<span class="cm">     */</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">otw_format</span><span class="p">;</span>

    <span class="cm">/*!</span>
<span class="cm">     * The args parameter is used to pass arbitrary key/value pairs.</span>
<span class="cm">     * Possible keys used by args (depends on implementation):</span>
<span class="cm">     *</span>
<span class="cm">     * - fullscale: specifies the full-scale amplitude when using floats.</span>
<span class="cm">     * By default, the fullscale amplitude under floating point is 1.0.</span>
<span class="cm">     * Set the &quot;fullscale&quot; to scale the samples in the host to the</span>
<span class="cm">     * expected input range and/or output range of your application.</span>
<span class="cm">     *</span>
<span class="cm">     * - peak: specifies a fractional sample level to calculate scaling with the sc8 wire</span>
<span class="cm">     * format. When using sc8 samples over the wire, the device must scale samples (both</span>
<span class="cm">     * on the host and in the device) to satisfy the dynamic range needs. The peak value</span>
<span class="cm">     * specifies a fraction of the maximum sample level (1.0 = 100%). Set peak to</span>
<span class="cm">     * max_sample_level/full_scale_level to ensure optimum dynamic range.</span>
<span class="cm">     *</span>
<span class="cm">     * - underflow_policy: how the TX DSP should recover from underflow.</span>
<span class="cm">     * Possible options are &quot;next_burst&quot; or &quot;next_packet&quot;.</span>
<span class="cm">     * In the &quot;next_burst&quot; mode, the DSP drops incoming packets until a new burst is</span>
<span class="cm">     * started. In the &quot;next_packet&quot; mode, the DSP starts transmitting again at the next</span>
<span class="cm">     * packet.</span>
<span class="cm">     *</span>
<span class="cm">     * - spp: (samples per packet) controls the size of RX packets.</span>
<span class="cm">     * When not specified, the packets are always maximum frame size.</span>
<span class="cm">     * Users should specify this option to request smaller than default</span>
<span class="cm">     * packets, probably with the intention of reducing packet latency.</span>
<span class="cm">     *</span>
<span class="cm">     * - noclear: Used by tx_dsp_core_200 and rx_dsp_core_200</span>
<span class="cm">     *</span>
<span class="cm">     * The following are not implemented, but are listed for conceptual purposes:</span>
<span class="cm">     * - function: magnitude or phase/magnitude</span>
<span class="cm">     * - units: numeric units like counts or dBm</span>
<span class="cm">     *</span>
<span class="cm">     * Other options are device-specific:</span>
<span class="cm">     * - port, addr: Alternative receiver streamer destination.</span>
<span class="cm">     */</span>
    <span class="n">device_addr_t</span> <span class="n">args</span><span class="p">;</span>

    <span class="cm">/*!</span>
<span class="cm">     * The channels is a list of channel numbers.</span>
<span class="cm">     * Leave this blank to default to channel 0 (single-channel application).</span>
<span class="cm">     * Set channels for a multi-channel application.</span>
<span class="cm">     * Channel mapping depends on the front-end selection (see also \ref config_subdev).</span>
<span class="cm">     *</span>
<span class="cm">     * A very simple example is an X300 with two daughterboards and a subdev spec</span>
<span class="cm">     * of `A:0 B:0`. This means the device has two channels available.</span>
<span class="cm">     *</span>
<span class="cm">     * Setting `stream_args.channels = (0, 1)` therefore configures MIMO streaming</span>
<span class="cm">     * from both channels. By switching the channel indexes, `stream_args.channels = (1,</span>
<span class="cm">     * 0)`, the channels are switched and the first channel of the USRP is mapped to the</span>
<span class="cm">     * second channel in the application.</span>
<span class="cm">     *</span>
<span class="cm">     * If only a single channel is used for streaming, `stream_args.channels = (1,)` would</span>
<span class="cm">     * only select a single channel (in this case, the second one). When streaming</span>
<span class="cm">     * a single channel from the B-side radio of a USRP, this is a more versatile solution</span>
<span class="cm">     * than setting the subdev globally to &quot;B:0&quot;.</span>
<span class="cm">     */</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span> <span class="n">channels</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*!</span>
<span class="cm"> * The RX streamer is the host interface to receiving samples.</span>
<span class="cm"> * It represents the layer between the samples on the host</span>
<span class="cm"> * and samples inside the device&#39;s receive DSP processing.</span>
<span class="cm"> */</span>
<span class="k">class</span> <span class="nc">UHD_API</span> <span class="nl">rx_streamer</span> <span class="p">:</span> <span class="n">uhd</span><span class="o">::</span><span class="n">noncopyable</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">typedef</span> <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">rx_streamer</span><span class="o">&gt;</span> <span class="n">sptr</span><span class="p">;</span>

    <span class="k">virtual</span> <span class="o">~</span><span class="n">rx_streamer</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

    <span class="c1">//! Get the number of channels associated with this streamer</span>
    <span class="k">virtual</span> <span class="kt">size_t</span> <span class="n">get_num_channels</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">//! Get the max number of samples per buffer per packet</span>
    <span class="k">virtual</span> <span class="kt">size_t</span> <span class="n">get_max_num_samps</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">//! Typedef for a pointer to a single, or a collection of recv buffers</span>
    <span class="k">typedef</span> <span class="n">ref_vector</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">*&gt;</span> <span class="n">buffs_type</span><span class="p">;</span>

    <span class="cm">/*!</span>
<span class="cm">     * Receive buffers containing samples described by the metadata.</span>
<span class="cm">     *</span>
<span class="cm">     * Receive handles fragmentation as follows:</span>
<span class="cm">     * If the buffer has insufficient space to hold all samples</span>
<span class="cm">     * that were received in a single packet over-the-wire,</span>
<span class="cm">     * then the buffer will be completely filled and the implementation</span>
<span class="cm">     * will hold a pointer into the remaining portion of the packet.</span>
<span class="cm">     * Subsequent calls will load from the remainder of the packet,</span>
<span class="cm">     * and will flag the metadata to show that this is a fragment.</span>
<span class="cm">     * The next call to receive, after the remainder becomes exhausted,</span>
<span class="cm">     * will perform an over-the-wire receive as usual.</span>
<span class="cm">     * See the rx metadata fragment flags and offset fields for details.</span>
<span class="cm">     *</span>
<span class="cm">     * This is a blocking call and will not return until the number</span>
<span class="cm">     * of samples returned have been written into each buffer.</span>
<span class="cm">     * Under a timeout condition, the number of samples returned</span>
<span class="cm">     * may be less than the number of samples specified.</span>
<span class="cm">     *</span>
<span class="cm">     * The one_packet option allows the user to guarantee that</span>
<span class="cm">     * the call will return after a single packet has been processed.</span>
<span class="cm">     * This may be useful to maintain packet boundaries in some cases.</span>
<span class="cm">     *</span>
<span class="cm">     * Note on threading: recv() is *not* thread-safe, to avoid locking</span>
<span class="cm">     * overhead. The application calling recv() is responsible for making</span>
<span class="cm">     * sure that not more than one thread can call recv() on the same streamer</span>
<span class="cm">     * at the same time. If there are multiple streamers, receiving from</span>
<span class="cm">     * different sources, then those may be called from different threads</span>
<span class="cm">     * simultaneously.</span>
<span class="cm">     *</span>
<span class="cm">     * \param buffs a vector of writable memory to fill with samples</span>
<span class="cm">     * \param nsamps_per_buff the size of each buffer in number of samples</span>
<span class="cm">     * \param metadata data to fill describing the buffer</span>
<span class="cm">     * \param timeout the timeout in seconds to wait for a packet</span>
<span class="cm">     * \param one_packet return after the first packet is received</span>
<span class="cm">     * \return the number of samples received or 0 on error</span>
<span class="cm">     */</span>
    <span class="k">virtual</span> <span class="kt">size_t</span> <span class="n">recv</span><span class="p">(</span><span class="k">const</span> <span class="n">buffs_type</span><span class="o">&amp;</span> <span class="n">buffs</span><span class="p">,</span>
        <span class="k">const</span> <span class="kt">size_t</span> <span class="n">nsamps_per_buff</span><span class="p">,</span>
        <span class="n">rx_metadata_t</span><span class="o">&amp;</span> <span class="n">metadata</span><span class="p">,</span>
        <span class="k">const</span> <span class="kt">double</span> <span class="n">timeout</span>  <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="k">const</span> <span class="kt">bool</span> <span class="n">one_packet</span> <span class="o">=</span> <span class="nb">false</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="cm">/*!</span>
<span class="cm">     * Issue a stream command to the usrp device.</span>
<span class="cm">     * This tells the usrp to send samples into the host.</span>
<span class="cm">     * See the documentation for stream_cmd_t for more info.</span>
<span class="cm">     *</span>
<span class="cm">     * With multiple devices, the first stream command in a chain of commands</span>
<span class="cm">     * should have a time spec in the near future and stream_now = false;</span>
<span class="cm">     * to ensure that the packets can be aligned by their time specs.</span>
<span class="cm">     *</span>
<span class="cm">     * \param stream_cmd the stream command to issue</span>
<span class="cm">     */</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">issue_stream_cmd</span><span class="p">(</span><span class="k">const</span> <span class="n">stream_cmd_t</span><span class="o">&amp;</span> <span class="n">stream_cmd</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*!</span>
<span class="cm"> * The TX streamer is the host interface to transmitting samples.</span>
<span class="cm"> * It represents the layer between the samples on the host</span>
<span class="cm"> * and samples inside the device&#39;s transmit DSP processing.</span>
<span class="cm"> */</span>
<span class="k">class</span> <span class="nc">UHD_API</span> <span class="nl">tx_streamer</span> <span class="p">:</span> <span class="n">uhd</span><span class="o">::</span><span class="n">noncopyable</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">typedef</span> <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">tx_streamer</span><span class="o">&gt;</span> <span class="n">sptr</span><span class="p">;</span>

    <span class="k">virtual</span> <span class="o">~</span><span class="n">tx_streamer</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

    <span class="c1">//! Get the number of channels associated with this streamer</span>
    <span class="k">virtual</span> <span class="kt">size_t</span> <span class="n">get_num_channels</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">//! Get the max number of samples per buffer per packet</span>
    <span class="k">virtual</span> <span class="kt">size_t</span> <span class="n">get_max_num_samps</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">//! Typedef for a pointer to a single, or a collection of send buffers</span>
    <span class="k">typedef</span> <span class="n">ref_vector</span><span class="o">&lt;</span><span class="k">const</span> <span class="kt">void</span><span class="o">*&gt;</span> <span class="n">buffs_type</span><span class="p">;</span>

    <span class="cm">/*!</span>
<span class="cm">     * Send buffers containing samples described by the metadata.</span>
<span class="cm">     *</span>
<span class="cm">     * Send handles fragmentation as follows:</span>
<span class="cm">     * If the buffer has more items than the maximum per packet,</span>
<span class="cm">     * the send method will fragment the samples across several packets.</span>
<span class="cm">     * Send will respect the burst flags when fragmenting to ensure</span>
<span class="cm">     * that start of burst can only be set on the first fragment and</span>
<span class="cm">     * that end of burst can only be set on the final fragment.</span>
<span class="cm">     *</span>
<span class="cm">     * This is a blocking call and will not return until the number</span>
<span class="cm">     * of samples returned have been read out of each buffer.</span>
<span class="cm">     * Under a timeout condition, the number of samples returned</span>
<span class="cm">     * may be less than the number of samples specified.</span>
<span class="cm">     *</span>
<span class="cm">     * Note on threading: send() is *not* thread-safe, to avoid locking</span>
<span class="cm">     * overhead. The application calling send() is responsible for making</span>
<span class="cm">     * sure that not more than one thread can call send() on the same streamer</span>
<span class="cm">     * at the same time. If there are multiple streamers, transmitting to</span>
<span class="cm">     * different destinations, then those may be called from different threads</span>
<span class="cm">     * simultaneously.</span>
<span class="cm">     *</span>
<span class="cm">     * \param buffs a vector of read-only memory containing samples</span>
<span class="cm">     * \param nsamps_per_buff the number of samples to send, per buffer</span>
<span class="cm">     * \param metadata data describing the buffer&#39;s contents</span>
<span class="cm">     * \param timeout the timeout in seconds to wait on a packet</span>
<span class="cm">     * \return the number of samples sent</span>
<span class="cm">     */</span>
    <span class="k">virtual</span> <span class="kt">size_t</span> <span class="n">send</span><span class="p">(</span><span class="k">const</span> <span class="n">buffs_type</span><span class="o">&amp;</span> <span class="n">buffs</span><span class="p">,</span>
        <span class="k">const</span> <span class="kt">size_t</span> <span class="n">nsamps_per_buff</span><span class="p">,</span>
        <span class="k">const</span> <span class="n">tx_metadata_t</span><span class="o">&amp;</span> <span class="n">metadata</span><span class="p">,</span>
        <span class="k">const</span> <span class="kt">double</span> <span class="n">timeout</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="cm">/*!</span>
<span class="cm">     * Receive and asynchronous message from this TX stream.</span>
<span class="cm">     * \param async_metadata the metadata to be filled in</span>
<span class="cm">     * \param timeout the timeout in seconds to wait for a message</span>
<span class="cm">     * \return true when the async_metadata is valid, false for timeout</span>
<span class="cm">     */</span>
    <span class="k">virtual</span> <span class="kt">bool</span> <span class="n">recv_async_msg</span><span class="p">(</span>
        <span class="n">async_metadata_t</span><span class="o">&amp;</span> <span class="n">async_metadata</span><span class="p">,</span> <span class="kt">double</span> <span class="n">timeout</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="p">}</span> <span class="c1">// namespace uhd</span>

<span class="cp">#endif </span><span class="cm">/* INCLUDED_UHD_STREAM_HPP */</span><span class="cp"></span>
</pre></div>
</td></tr></table></div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="txrx_stream.html" title="previous page"><span class="section-number">2.4.4. </span><code class="docutils literal notranslate"><span class="pre">txrx_loopback_to_file.cpp</span></code> (stream)</a>
    <a class='right-next' id="next-link" href="tx_samples_from_file.html" title="next page"><span class="section-number">2.4.6. </span><code class="docutils literal notranslate"><span class="pre">tx_samples_from_file.cpp</span></code></a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tan F. Wong<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>